<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Create Post</title><script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-database-compat.js"></script><link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"><style>body{background:#0d0d0d;color:#c9f4d6;font-family:Inter,sans-serif}.btn{background:#064e3b;color:#c9f4d6;padding:.5rem 1rem;border-radius:.5rem;transition:.2s}.btn:hover{background:#10b981;color:#0d0d0d}.tag-btn{background:#065f46;color:#a7f3d0;border-radius:.25rem;padding:.25rem .5rem;margin-right:.5rem;cursor:pointer}.tag-btn.active{background:#10b981;color:#0d0d0d}#postContent{background:#1a1a1a;color:#d1fae5;border:1px solid #065f46;min-height:200px;padding:10px;border-radius:.5rem}input,select{background:#1a1a1a;color:#a7f3d0;border:1px solid #065f46;border-radius:.5rem;padding:.5rem;width:100%}</style></head><body class="p-4 md:p-6"><h1 class="text-3xl font-bold text-green-300 mb-4 text-center">Create Anonymous Post</h1><div class="mb-3"><input id="schoolCodeInput" placeholder="Enter School Code..." maxlength="20"/><div id="schoolName" class="text-green-400 mt-2 text-center"></div></div><div class="flex flex-wrap mb-3"><div class="tag-btn" data-tag="Code">Code</div><div class="tag-btn" data-tag="Writing">Writing</div><div class="tag-btn" data-tag="Art">Art</div><div class="tag-btn" data-tag="Links">Links</div><div class="tag-btn" data-tag="Other">Other</div></div><div contenteditable="true" id="postContent" class="mb-4"></div><div class="flex flex-wrap gap-3 mb-6"><button id="boldBtn" class="btn w-full sm:w-auto">Bold</button><button id="postBtn" class="btn w-full sm:w-auto">Post</button></div><a href="index" class="text-green-300 underline block text-center">View All Posts</a><script>const firebaseConfig={apiKey:"AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw",authDomain:"easy-chatroom.firebaseapp.com",databaseURL:"https://easy-chatroom-default-rtdb.firebaseio.com",projectId:"easy-chatroom",storageBucket:"easy-chatroom.firebasestorage.app",messagingSenderId:"985049198428",appId:"1:985049198428:web:0cad8f285943b9f10c9b99",measurementId:"G-Q0YZGZLEMM"};firebase.initializeApp(firebaseConfig);const db=firebase.database();function getDeviceId(){let e=localStorage.getItem("deviceId");return e||(e="device-"+Math.random().toString(36).substring(2,15),localStorage.setItem("deviceId",e)),e}const deviceId=getDeviceId(),content=document.getElementById("postContent"),boldBtn=document.getElementById("boldBtn"),postBtn=document.getElementById("postBtn"),tagButtons=document.querySelectorAll(".tag-btn"),schoolInput=document.getElementById("schoolCodeInput"),schoolName=document.getElementById("schoolName");async function showSchoolName(e){if(!e)return schoolName.textContent="";const t=await db.ref("schools/"+e+"/name").get();t.exists()?(schoolName.textContent="ðŸ« "+t.val(),localStorage.setItem("schoolCode",e)):(schoolName.textContent="",alert("School code not found."))}schoolInput.value=localStorage.getItem("schoolCode")||"",schoolInput.addEventListener("change",()=>{showSchoolName(schoolInput.value.trim())});if(schoolInput.value)showSchoolName(schoolInput.value.trim());let selectedTags=[];tagButtons.forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("active");const t=e.dataset.tag;selectedTags.includes(t)?selectedTags=selectedTags.filter(e=>e!==t):selectedTags.push(t)})}),boldBtn.addEventListener("click",()=>document.execCommand("bold"));function cleanText(e){const t=["fuck","shit","bitch","asshole","cunt","nigger","faggot","retard"];let n=e;return t.forEach(e=>{const t=new RegExp("\\b"+e+"\\b","gi");n=n.replace(t,e=>e.split("").map((e,t)=>t%2==0?"*":e).join(""))}),n}postBtn.addEventListener("click",async()=>{let e=schoolInput.value.trim();if(!e)return alert("Enter a school code first!");let t=content.innerHTML.trim();if(!t)return alert("Post cannot be empty!");t=cleanText(t);const n=await db.ref("posts/"+e).orderByChild("deviceId").equalTo(deviceId).get(),a=n.exists()?Object.entries(n.val()):[];if(a.length>=10){if(!confirm("You've reached your 10-post limit. Continue? Oldest post will be deleted."))return;const t=a.sort((e,t)=>e[1].createdAt-t[1].createdAt)[0][0];await db.ref("posts/"+e+"/"+t).remove()}const o=Date.now();await db.ref("posts/"+e+"/"+o).set({content:t,tags:selectedTags,createdAt:o,deviceId,schoolCode:e,upvotes:0}),alert("Post added successfully!"),content.innerHTML="",selectedTags=[],tagButtons.forEach(e=>e.classList.remove("active"))});</script></body></html>
