<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Posts</title><script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-database-compat.js"></script><link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"><style>body{background:#0d0d0d;color:#d1fae5;font-family:Inter,sans-serif}.post-card{background:#1a1a1a;border:1px solid #065f46;border-radius:.75rem;padding:1rem;margin-bottom:1rem}.tag{background:#065f46;color:#a7f3d0;border-radius:.25rem;padding:.25rem .5rem;margin-right:.5rem;display:inline-block}.filter-btn{background:#064e3b;color:#c9f4d6;padding:.5rem 1rem;margin:.25rem;border-radius:.5rem}.filter-btn.active{background:#10b981;color:#0d0d0d}</style></head><body class="p-4 md:p-6"><h1 class="text-3xl font-bold text-green-300 mb-4 text-center">Anonymous Board</h1><input id="schoolCodeInput" placeholder="Enter School Code..." class="w-full mb-2 p-2 bg-gray-900 border border-green-500 rounded text-green-200" maxlength="20"/><div id="schoolName" class="text-green-400 mb-3 text-center"></div><div id="tagFilters" class="flex flex-wrap mb-4 justify-center"><button class="filter-btn" data-tag="All">All</button><button class="filter-btn" data-tag="Code">Code</button><button class="filter-btn" data-tag="Writing">Writing</button><button class="filter-btn" data-tag="Art">Art</button><button class="filter-btn" data-tag="Links">Links</button><button class="filter-btn" data-tag="Other">Other</button></div><select id="sortOption" class="bg-gray-900 border border-green-500 text-green-200 rounded p-2 mb-6 w-full sm:w-auto"><option value="newest">Newest</option><option value="upvoted">Most Upvoted</option></select><div id="postsContainer"></div><script>const firebaseConfig={apiKey:"AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw",authDomain:"easy-chatroom.firebaseapp.com",databaseURL:"https://easy-chatroom-default-rtdb.firebaseio.com",projectId:"easy-chatroom",storageBucket:"easy-chatroom.firebasestorage.app",messagingSenderId:"985049198428",appId:"1:985049198428:web:0cad8f285943b9f10c9b99",measurementId:"G-Q0YZGZLEMM"};firebase.initializeApp(firebaseConfig);const db=firebase.database();function getDeviceId(){let e=localStorage.getItem("deviceId");return e||(e="device-"+Math.random().toString(36).substring(2,15),localStorage.setItem("deviceId",e)),e}const deviceId=getDeviceId(),postsContainer=document.getElementById("postsContainer"),filterBtns=document.querySelectorAll(".filter-btn"),sortOption=document.getElementById("sortOption"),schoolInput=document.getElementById("schoolCodeInput"),schoolName=document.getElementById("schoolName");async function showSchoolName(e){if(!e)return schoolName.textContent="";const t=await db.ref("schools/"+e+"/name").get();t.exists()?(schoolName.textContent="üè´ "+t.val(),localStorage.setItem("schoolCode",e),loadPosts()):(schoolName.textContent="",postsContainer.innerHTML='<div class="text-center text-gray-400">Invalid school code.</div>')}schoolInput.value=localStorage.getItem("schoolCode")||"",schoolInput.addEventListener("change",()=>{showSchoolName(schoolInput.value.trim())});if(schoolInput.value)showSchoolName(schoolInput.value.trim());let currentFilter="All",allPosts=[];filterBtns.forEach(e=>{e.addEventListener("click",()=>{filterBtns.forEach(e=>e.classList.remove("active")),e.classList.add("active"),currentFilter=e.dataset.tag,displayPosts()})}),sortOption.addEventListener("change",displayPosts);function displayPosts(){postsContainer.innerHTML="";let e="All"===currentFilter?allPosts:allPosts.filter(e=>e.tags&&e.tags.includes(currentFilter));"upvoted"===sortOption.value?e.sort((e,t)=>(t.upvotes||0)-(e.upvotes||0)):e.sort((e,t)=>t.createdAt-e.createdAt),e.forEach(e=>{const t=document.createElement("div");t.className="post-card";const n=e.tags?.map(e=>`<span class="tag">${e}</span>`).join(" ")||"",a=new Date(e.createdAt).toLocaleString();t.innerHTML=`<div class="text-sm text-green-400 mb-2">${a}</div><div class="mb-3">${e.content}</div><div class="flex justify-between items-center"><div>${n}</div><button class="upvote text-green-400" data-id="${e.id}">‚¨ÜÔ∏è ${e.upvotes||0}</button></div>`,postsContainer.appendChild(t)}),document.querySelectorAll(".upvote").forEach(e=>e.addEventListener("click",handleUpvote))}async function handleUpvote(e){const t=e.target.dataset.id,n=localStorage.getItem("schoolCode");if(!n)return alert("Enter a school code first!");const a=db.ref("posts/"+n+"/"+t),o=await a.get();if(!o.exists())return;const s=o.val();if(s.upvotedBy&&s.upvotedBy[deviceId])return alert("You already upvoted.");const c=(s.upvotes||0)+1;await a.update({upvotes:c,[`upvotedBy/${deviceId}`]:!0})}function loadPosts(){const e=localStorage.getItem("schoolCode");if(!e)return void(postsContainer.innerHTML='<div class="text-center text-gray-400">Enter a school code to view posts.</div>');db.ref("posts/"+e).on("value",t=>{const n=t.val()||{};allPosts=Object.keys(n).map(e=>({id:e,...n[e]})),displayPosts()})}</script></body></html>
