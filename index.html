<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><title>All Posts</title><script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-database-compat.js"></script><link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"><style>body{background:#0d0d0d;color:#d1fae5;font-family:'Inter',sans-serif}.post-card{background:#1a1a1a;border:1px solid #065f46;border-radius:.75rem;padding:1rem;margin-bottom:1rem}.tag{background:#065f46;color:#a7f3d0;border-radius:.25rem;padding:.25rem .5rem;margin-right:.5rem;display:inline-block}.filter-btn{background:#064e3b;color:#c9f4d6;padding:.5rem 1rem;margin:.25rem;border-radius:.5rem}.filter-btn.active{background:#10b981;color:#0d0d0d}</style></head><body class="p-6"><h1 class="text-3xl font-bold text-green-300 mb-4">Recent Anonymous Posts</h1><div id="tagFilters" class="flex flex-wrap mb-4"><button class="filter-btn" data-tag="All">All</button><button class="filter-btn" data-tag="Code">Code</button><button class="filter-btn" data-tag="Writing">Writing</button><button class="filter-btn" data-tag="Art">Art</button><button class="filter-btn" data-tag="Links">Links</button><button class="filter-btn" data-tag="Other">Other</button></div><select id="sortOption" class="bg-gray-900 border border-green-500 text-green-200 rounded p-2 mb-6"><option value="newest">Newest</option><option value="upvoted">Most Upvoted</option></select><div id="postsContainer"></div><script>const firebaseConfig={apiKey:"AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw",authDomain:"easy-chatroom.firebaseapp.com",databaseURL:"https://easy-chatroom-default-rtdb.firebaseio.com",projectId:"easy-chatroom",storageBucket:"easy-chatroom.firebasestorage.app",messagingSenderId:"985049198428",appId:"1:985049198428:web:0cad8f285943b9f10c9b99",measurementId:"G-Q0YZGZLEMM"};firebase.initializeApp(firebaseConfig);const db=firebase.database();function getDeviceId(){let id=localStorage.getItem("deviceId");if(!id){id="device-"+Math.random().toString(36).substring(2,15);localStorage.setItem("deviceId",id)}return id}const deviceId=getDeviceId();const postsContainer=document.getElementById("postsContainer");const filterBtns=document.querySelectorAll(".filter-btn");const sortOption=document.getElementById("sortOption");let currentFilter="All",allPosts=[];filterBtns.forEach(btn=>{btn.addEventListener("click",()=>{filterBtns.forEach(b=>b.classList.remove("active"));btn.classList.add("active");currentFilter=btn.dataset.tag;displayPosts()})});sortOption.addEventListener("change",displayPosts);function displayPosts(){postsContainer.innerHTML="";let filtered=currentFilter==="All"?allPosts:allPosts.filter(p=>p.tags&&p.tags.includes(currentFilter));if(sortOption.value==="upvoted"){filtered.sort((a,b)=>(b.upvotes||0)-(a.upvotes||0))}else{filtered.sort((a,b)=>b.createdAt-a.createdAt)}filtered.forEach(p=>{const div=document.createElement("div");div.className="post-card";const tags=p.tags?.map(t=>`<span class="tag">${t}</span>`).join(" ")||"";const date=new Date(p.createdAt).toLocaleString();div.innerHTML=`<div class="text-sm text-green-400 mb-2">${date}</div><div class="mb-3">${p.content}</div><div class="flex justify-between items-center"><div>${tags}</div><div class="flex items-center gap-3"><button class="upvote text-green-400" data-id="${p.id}">‚¨ÜÔ∏è ${p.upvotes||0}</button><button class="report text-red-400" data-id="${p.id}">üö©</button></div></div>`;postsContainer.appendChild(div)});document.querySelectorAll(".upvote").forEach(btn=>btn.addEventListener("click",handleUpvote));document.querySelectorAll(".report").forEach(btn=>btn.addEventListener("click",handleReport))}async function handleUpvote(e){const postId=e.target.dataset.id,postRef=db.ref("posts/"+postId),snap=await postRef.get();if(!snap.exists())return;const data=snap.val();if(data.upvotedBy&&data.upvotedBy[deviceId])return alert("You already upvoted.");const newUpvotes=(data.upvotes||0)+1;await postRef.update({upvotes:newUpvotes,[`upvotedBy/${deviceId}`]:true})}async function handleReport(e){const postId=e.target.dataset.id,postRef=db.ref("posts/"+postId),snap=await postRef.get();if(!snap.exists())return;const data=snap.val();if(data.reportedBy&&data.reportedBy[deviceId])return alert("You already reported.");const newReports=(data.reports||0)+1;if(newReports>=5){await postRef.remove();alert("Post removed (5 reports).")}else{await postRef.update({reports:newReports,[`reportedBy/${deviceId}`]:true});alert("Post reported.")}}db.ref("posts").on("value",snapshot=>{const posts=snapshot.val()||{};allPosts=Object.keys(posts).map(id=>({id,...posts[id]}));displayPosts()});</script></body></html>